Booking Model Features:

Relationships: Links to Student, Teacher, Course, Payment, Sessions, Availability Slots, 
and Reviews
Status Management: Pending payment, confirmed, in-progress, completed, cancelled
Session Types: Single sessions or package deals
Scopes: For filtering active, upcoming, completed bookings
Calculated Attributes: Progress percentage, remaining sessions, cancellation/rescheduling 
eligibility
Methods: Cancel booking with refund calculation, mark as completed, increment session 
progress

Payment Model Features:

Payment Methods: Card, wallet, bank transfer, Apple Pay, STC Pay
Status Tracking: Pending, processing, completed, failed, refunded
Refund Management: Full refund processing workflow
Gateway Integration: Support for transaction references and gateway responses
Business Logic: 30-day refund policy, net amount calculations
Auto-generated References: Unique transaction references and invoice numbers

Key Business Logic:

Cancellation Policy:

48+ hours: 100% refund
24-48 hours: 80% refund
4-24 hours: 50% refund
<4 hours: No refund


Session Management: Automatic booking completion when all sessions are finished
Payment Flow: Booking status updates automatically when payment is completed
Security: Proper model events and validation for data integrity

The models work seamlessly with your API controllers and provide all the functionality 
needed for your tutoring platform. Each model includes proper constants, scopes, 
accessors, and business methods to handle the complex booking and payment workflows.

///////////////////////////////////////////////////////////////////////////////////////////////////
AvailabilitySlot Model Features:
Core Properties:

teacher_id - Which teacher owns this slot
course_id - Which course this slot is for
date - The date of the slot
start_time & end_time - Time range
duration - Calculated in minutes
is_available - Can be booked
is_booked - Currently booked
booking_id - Link to booking if booked
repeat_type - none/weekly/daily for recurring slots

Key Relationships:

Teacher: The teacher who owns the slot
Course: The specific course this slot is for
Booking: The booking that reserved this slot (if booked)

Powerful Scopes:

available() - Only available and not booked slots
upcoming() - Future slots only
inDateRange() - Filter by date range
forTeacher() - Slots for specific teacher
today() - Today's slots only

Smart Accessors:

is_bookable - Checks if slot can be booked (available + 2hr advance notice)
status - Dynamic status (available/booked/expired/unavailable)
formatted_time - Pretty time display "09:00 - 09:50"
day_name_arabic - Arabic day names
time_until_start - Human readable countdown

Business Methods:

book(Booking $booking) - Reserve the slot
unbook() - Free up the slot
overlaps() - Check time conflicts
isPast() - Check if slot has passed
reschedule() - Change time/date

Bulk Operations:

createRecurringSlots() - Generate weekly recurring slots
generateWeeklySchedule() - Create teacher's weekly schedule
getTeacherAvailability() - Get formatted availability for frontend

Validation & Business Rules:

Auto-calculates duration on creation
Prevents booking unavailable slots
Prevents deleting booked slots
Validates end_time > start_time
Checks for scheduling conflicts
Enforces 2-hour advance booking policy

This model handles all the complex scheduling logic for your tutoring platform, 
from simple slot booking to recurring schedules and conflict detection!

zoom account ID 
MXUESvuZSfebrMHxoPcWJw

Cleint ID
rgw2P9FVST6ep67mQMD97Q

Secret Key
7ik2ZHJ7r2XvsZorRUuze1hEWNhdmpeu

Secret Token
ek0K8lrURLGd7hNk4LO1yw


// Add this to routes/web.php

Route::get('paid', function () {
    return view('paid');
});

Route::get('check_hyper/{order_id}', function ($order_id) {
    
    // Get payment result parameters
    $checkout_id = request('id');
    $resourcePath = request('resourcePath');
    
    if(!$checkout_id){
        return redirect('/declinepaid');
    }
    
    // Get order details
    $order = DB::table('orders')->where('id', $order_id)->first();
    
    if(!$order){
        return redirect('/declinepaid');
    }
    
    $payment_gway_type = $order->payment_gway_type;
    
    // Check payment status
    $response = get_payment_status_request($checkout_id, $payment_gway_type);
    $data = json_decode($response->getContent());
    
    // Check result code
    if(isset($data->data->result->code)){
        $code = $data->data->result->code;
        
        // Success codes pattern: /^(000\.000\.|000\.100\.1|000\.[36])/
        if(preg_match('/^(000\.000\.|000\.100\.1|000\.[36])/', $code)){
            // Payment successful
            // Update order status in database
            DB::table('orders')->where('id', $order_id)->update([
                'payment_status' => 'paid',
                'transaction_id' => $checkout_id,
                'updated_at' => now()
            ]);
            
            return redirect('/successpaid');
        }
        // Pending codes pattern: /^(000\.200)/
        elseif(preg_match('/^(000\.200)/', $code)){
            return view('pending_payment');
        }
        // Any other code means declined/failed
        else{
            return redirect('/declinepaid');
        }
    }
    
    return redirect('/declinepaid');
});

// Payment response pages
Route::get('successpaid', function () {
    echo "<h2>Payment Done Successfully</h2>";
    echo '<p>Your payment has been processed successfully.</p>';
    echo '<button type="button" onclick="window.close();">Close Window</button>';
});

Route::get('cancelpaid', function () {
    echo "<h2>Payment Canceled</h2>";
    echo '<p>Your payment has been canceled.</p>';
    echo '<button type="button" onclick="window.close();">Close Window</button>';
});

Route::get('declinepaid', function () {
    echo "<h2>Payment Declined</h2>";
    echo '<p>Your payment has been declined. Please try again.</p>';
    echo '<button type="button" onclick="window.close();">Close Window</button>';
});
Route::get('/payment-test', function () {
    return view('payment'); // the Blade file above
});





// // locale set
// Route::group(['prefix' => '{locale}', 'middleware' => 'LocaleMiddleware'], function () {
//     require __DIR__ . '/auth.php';
//     Route::get('/', function () {
//         return redirect()->route('login', ['locale' => app()->getLocale()]);
//     });    // Authentication Routes
//     Route::get('/check-role', function () {
//         // This will never render, always redirects
//     })->middleware(['auth', 'check.role'])->name('check.role');

//     // ðŸ”’ All routes require login
//     Route::middleware(['auth'])->group(function () {

//         // ===========================
//         // Visitor (incomplete profile)
//         // ===========================
//         Route::prefix('visitor')->group(function () {
//             Route::get('complete-profile', [UserController::class, 'completeProfile'])
//                 ->name('profile.complete');
//             Route::post('complete-profile', [UserController::class, 'storeProfile'])
//                 ->name('profile.store');
//         });

//         // ===========================
//         // Admin
//         // ===========================
//         Route::prefix('admin')->middleware(['auth', 'role:admin'])->group(function () {
//             Route::get('dashboard', [AdminController::class, 'index'])
//                 ->name('admin.dashboard');
//             // Services CRUD
//             Route::resource('services', ServicesController::class)->names('admin.services');
//             Route::post('services/{id}/status', [ServicesController::class, 'updateStatus'])->name('admin.services.status');
//             // Users CRUD
//             Route::resource('users', UserController::class)->names('admin.users');

//             // Courses CRUD
//             Route::resource('courses', CourseController::class)->names('admin.courses');

//             // Bookings CRUD
//             Route::resource('bookings', BookingController::class)->names('admin.bookings');

//             // Payments CRUD
//             Route::resource('payments', PaymentController::class)->names('admin.payments');

//             // Disputes CRUD
//             Route::resource('disputes', DisputeController::class)->names('admin.disputes');

//             // Support Tickets CRUD
//             Route::resource('support-tickets', SupportTicketController::class)->names('admin.support-tickets');

//             // Notifications CRUD
//             Route::resource('notifications', NotificationController::class)->names('admin.notifications');

//             // Settings (usually just edit/update)
//             Route::get('settings', [SettingController::class, 'index'])->name('admin.settings.index');
//             Route::post('settings', [SettingController::class, 'update'])->name('admin.settings.update');

//             // Reports
//             Route::get('reports/finance', [ReportsController::class, 'finance'])->name('admin.reports.finance');
//             Route::get('reports/users', [ReportsController::class, 'users'])->name('admin.reports.users');
//         });
//     });

//     // Services & Subjects
//     Route::get('/services', [HomeController::class, 'index'])->name('services.index');
//     Route::get('/services/{id}', [HomeController::class, 'show'])->name('services.show');
//     Route::get('/subjects/{id}', [HomeController::class, 'subjectDetails'])->name('subjects.show');

//     // Courses (Public)
//     Route::get('/courses', [HomeController::class, 'courses'])->name('courses.index');
//     Route::get('/courses/{id}', [HomeController::class, 'courseDetails'])->name('courses.show');

//     // Teachers (Public)
//     Route::get('/teachers', [HomeController::class, 'teachers'])->name('teachers.index');
//     Route::get('/teachers/{id}', [HomeController::class, 'teacherProfile'])->name('teachers.show');

//     // Profile Routes (Shared between Student & Teacher)
//     Route::middleware(['auth'])->prefix('profile')->name('profile.')->group(function () {
//         Route::get('/', [UserController::class, 'show'])->name('show');
//         Route::get('/edit', [UserController::class, 'edit'])->name('edit');
//         Route::put('/update', [UserController::class, 'update'])->name('update');
//         Route::get('/change-password', [UserController::class, 'showChangePassword'])->name('password');
//         Route::post('/change-password', [UserController::class, 'changePassword'])->name('password.update');
//     });

//     // ==========================================
//     // Student Routes
//     // ==========================================
//     Route::middleware(['auth', 'role:student'])->prefix('student')->name('student.')->group(function () {

//         // Dashboard
//         Route::get('/dashboard', [StudentController::class, 'index'])->name('dashboard');

//         // Courses
//         Route::prefix('courses')->name('courses.')->group(function () {
//             Route::get('/', [StudentCourseController::class, 'index'])->name('index');
//             Route::get('/{id}', [StudentCourseController::class, 'show'])->name('show');
//             Route::post('/{id}/enroll', [StudentCourseController::class, 'enroll'])->name('enroll');
//             Route::get('/{course_id}/lessons', [StudentCourseController::class, 'lessons'])->name('lessons');
//             Route::get('/{course_id}/lessons/{lesson_id}', [StudentCourseController::class, 'showLesson'])->name('lessons.show');
//             Route::post('/{course_id}/lessons/{lesson_id}/complete', [StudentCourseController::class, 'completeLesson'])->name('lessons.complete');
//         });

//         // My Courses (Enrolled)
//         Route::get('/my-courses', [StudentCourseController::class, 'myCourses'])->name('my-courses');

//         // Orders
//         Route::prefix('orders')->name('orders.')->group(function () {
//             Route::get('/', [StudentOrderController::class, 'index'])->name('index');
//             Route::get('/create', [StudentOrderController::class, 'create'])->name('create');
//             Route::post('/', [StudentOrderController::class, 'store'])->name('store');
//             Route::get('/{id}', [StudentOrderController::class, 'show'])->name('show');
//             Route::get('/{id}/edit', [StudentOrderController::class, 'edit'])->name('edit');
//             Route::put('/{id}', [StudentOrderController::class, 'update'])->name('update');
//             Route::delete('/{id}', [StudentOrderController::class, 'destroy'])->name('destroy');
//             Route::get('/{id}/applications', [StudentOrderController::class, 'applications'])->name('applications');
//             Route::post('/{order_id}/applications/{application_id}/accept', [StudentOrderController::class, 'acceptApplication'])->name('applications.accept');
//         });

//         // Bookings
//         Route::prefix('bookings')->name('bookings.')->group(function () {
//             Route::get('/', [StudentBookingController::class, 'index'])->name('index');
//             Route::get('/create', [StudentBookingController::class, 'create'])->name('create');
//             Route::post('/', [StudentBookingController::class, 'store'])->name('store');
//             Route::get('/{id}', [StudentBookingController::class, 'show'])->name('show');
//             Route::put('/{id}/cancel', [StudentBookingController::class, 'cancel'])->name('cancel');
//         });

//         // Payments
//         Route::prefix('payments')->name('payments.')->group(function () {
//             Route::get('/history', [StudentPaymentController::class, 'history'])->name('history');
//             Route::get('/methods', [StudentPaymentController::class, 'methods'])->name('methods');
//             Route::post('/methods', [StudentPaymentController::class, 'addMethod'])->name('methods.add');
//         });

//         // Reviews
//         Route::prefix('reviews')->name('reviews.')->group(function () {
//             Route::get('/courses/{course_id}', [StudentReviewController::class, 'courseReviews'])->name('courses');
//             Route::post('/courses/{course_id}', [StudentReviewController::class, 'storeCourseReview'])->name('courses.store');
//             Route::get('/teachers/{teacher_id}', [StudentReviewController::class, 'teacherReviews'])->name('teachers');
//             Route::post('/teachers/{teacher_id}', [StudentReviewController::class, 'storeTeacherReview'])->name('teachers.store');
//             Route::delete('/{id}', [StudentReviewController::class, 'destroy'])->name('destroy');
//         });

//         // Disputes
//         Route::prefix('disputes')->name('disputes.')->group(function () {
//             Route::get('/', [StudentDisputeController::class, 'index'])->name('index');
//             Route::get('/create', [StudentDisputeController::class, 'create'])->name('create');
//             Route::post('/', [StudentDisputeController::class, 'store'])->name('store');
//             Route::get('/{id}', [StudentDisputeController::class, 'show'])->name('show');
//             Route::delete('/{id}', [StudentDisputeController::class, 'destroy'])->name('destroy');
//         });
//     });

//     // ==========================================
//     // Teacher Routes
//     // ==========================================
//     Route::middleware(['auth', 'role:teacher'])->prefix('teacher')->name('teacher.')->group(function () {

//         // Dashboard
//         Route::get('/dashboard', [TeacherController::class, 'index'])->name('dashboard');

//         // Teacher Info Setup
//         Route::get('/info', [TeacherController::class, 'showInfo'])->name('info');
//         Route::post('/info', [TeacherController::class, 'updateInfo'])->name('info.update');

//         // Courses
//         Route::prefix('courses')->name('courses.')->group(function () {
//             Route::get('/', [TeacherCourseController::class, 'index'])->name('index');
//             Route::get('/create', [TeacherCourseController::class, 'create'])->name('create');
//             Route::post('/', [TeacherCourseController::class, 'store'])->name('store');
//             Route::get('/{id}', [TeacherCourseController::class, 'show'])->name('show');
//             Route::get('/{id}/edit', [TeacherCourseController::class, 'edit'])->name('edit');
//             Route::put('/{id}', [TeacherCourseController::class, 'update'])->name('update');
//             Route::delete('/{id}', [TeacherCourseController::class, 'destroy'])->name('destroy');
//         });

//         // Lessons
//         Route::prefix('lessons')->name('lessons.')->group(function () {
//             Route::get('/courses/{course_id}', [TeacherLessonController::class, 'index'])->name('index');
//             Route::get('/courses/{course_id}/create', [TeacherLessonController::class, 'create'])->name('create');
//             Route::post('/courses/{course_id}', [TeacherLessonController::class, 'store'])->name('store');
//             Route::get('/{id}/edit', [TeacherLessonController::class, 'edit'])->name('edit');
//             Route::put('/{id}', [TeacherLessonController::class, 'update'])->name('update');
//             Route::delete('/{id}', [TeacherLessonController::class, 'destroy'])->name('destroy');
//         });

//         // Availability
//         Route::prefix('availability')->name('availability.')->group(function () {
//             Route::get('/', [TeacherAvailabilityController::class, 'index'])->name('index');
//             Route::get('/create', [TeacherAvailabilityController::class, 'create'])->name('create');
//             Route::post('/', [TeacherAvailabilityController::class, 'store'])->name('store');
//             Route::get('/{id}/edit', [TeacherAvailabilityController::class, 'edit'])->name('edit');
//             Route::put('/{id}', [TeacherAvailabilityController::class, 'update'])->name('update');
//             Route::delete('/{id}', [TeacherAvailabilityController::class, 'destroy'])->name('destroy');
//         });

//         // Orders (Browse & Apply)
//         Route::prefix('orders')->name('orders.')->group(function () {
//             Route::get('/browse', [TeacherApplicationController::class, 'browse'])->name('browse');
//             Route::get('/{id}', [TeacherApplicationController::class, 'show'])->name('show');
//             Route::post('/{id}/apply', [TeacherApplicationController::class, 'apply'])->name('apply');
//             Route::get('/applications/my', [TeacherApplicationController::class, 'myApplications'])->name('applications');
//             Route::delete('/applications/{id}', [TeacherApplicationController::class, 'cancelApplication'])->name('applications.cancel');
//         });

//         // Bookings
//         Route::prefix('bookings')->name('bookings.')->group(function () {
//             Route::get('/', [TeacherController::class, 'bookings'])->name('index');
//             Route::get('/{id}', [TeacherController::class, 'bookingDetails'])->name('show');
//         });

//         // Reviews
//         Route::prefix('reviews')->name('reviews.')->group(function () {
//             Route::get('/', [TeacherReviewController::class, 'index'])->name('index');
//         });

//         // Disputes
//         Route::prefix('disputes')->name('disputes.')->group(function () {
//             Route::get('/', [TeacherDisputeController::class, 'index'])->name('index');
//             Route::get('/create', [TeacherDisputeController::class, 'create'])->name('create');
//             Route::post('/', [TeacherDisputeController::class, 'store'])->name('store');
//             Route::get('/{id}', [TeacherDisputeController::class, 'show'])->name('show');
//             Route::delete('/{id}', [TeacherDisputeController::class, 'destroy'])->name('destroy');
//         });
//     });
// });


// Services & Subjects
    Route::get('/services', [HomeController::class, 'index'])->name('services.index');
    Route::get('/services/{id}', [HomeController::class, 'show'])->name('services.show');
    Route::get('/subjects/{id}', [HomeController::class, 'subjectDetails'])->name('subjects.show');

    // Courses (Public)
    Route::get('/courses', [HomeController::class, 'courses'])->name('courses.index');
    Route::get('/courses/{id}', [HomeController::class, 'courseDetails'])->name('courses.show');

    // Teachers (Public)
    Route::get('/teachers', [HomeController::class, 'teachers'])->name('teachers.index');
    Route::get('/teachers/{id}', [HomeController::class, 'teacherProfile'])->name('teachers.show');

    // Profile Routes (Shared between Student & Teacher)
    Route::middleware(['auth'])->prefix('profile')->name('profile.')->group(function () {
        Route::get('/', [UserController::class, 'show'])->name('show');
        Route::get('/edit', [UserController::class, 'edit'])->name('edit');
        Route::put('/update', [UserController::class, 'update'])->name('update');
        Route::get('/change-password', [UserController::class, 'showChangePassword'])->name('password');
        Route::post('/change-password', [UserController::class, 'changePassword'])->name('password.update');
    });



    

    Attempt to read property "id" on null ,C:\xampp\htdocs\full-version\app\Http\Controllers\Student\StudentCourseController
.php
â€‰
:â€‰87 am try to use this function to get all teachers that have a language study service and am try to use same courses blade files to display those teachers but without 



app id
git add app/Services/AgoraService.php app/Agora/RtcTokenBuilder.php ; 
git commit -m "Fix: use correct RtcTokenBuilder constant RolePublisher" ;
 git push origin main


 cd "/Applications/XAMPP/xamppfiles/htdocs/ewan backend/online_learning_platform" && 
 git fetch origin && git reset --hard origin/main && git clean -fd && 
 git status --porcelain && 
 git rev-parse --abbrev-ref HEAD && 
 git rev-parse --short HEAD


 {
    "success": false,
    "message": "Cannot add course slot: teacher already has a personal slot on day 1 at 09:00"
}


{
    "success": true,
    "data": {
        "current_page": 1,
        "data": [
            {
                "id": 24,
                "first_name": "ana",
                "last_name": "talib",
                "email": "talib@gmail.com",
                "phone_number": "+966-+966-+966-+966-+966-966573838872",
                "gender": "male",
                "role_id": 4,
                "is_active": 0,
                "profile_photo": "http://myewanlaravelapp.loca.lt/storage/profile_photos/dMGIqIUYNQoq2Rr6qYb9njMIXCFCJHUQZ6b5wGWR.jpg",
                "certificate": null
            },
            {
                "id": 23,
                "first_name": "Abdelrahman",
                "last_name": "tooot abodi",
                "email": "abodyy@gmail.com",
                "phone_number": "+966-573838811",
                "gender": "male",
                "role_id": 3,
                "is_active": 0,
                "profile_photo": "http://myewanlaravelapp.loca.lt/storage/profile_photos/GtI825R7YF83ssbmIVdm63KFz1ttxejqvtOMsuBM.jpg",
                "certificate": null
            },
            {
                "id": 22,
                "first_name": "abdelrahman",
                "last_name": "mahdi",
                "email": "abodyyy@gmail.com",
                "phone_number": "966579838870",
                "gender": "male",
                "role_id": 2,
                "is_active": 0,
                "profile_photo": null,
                "certificate": null
            },
            {
                "id": 20,
                "first_name": "mohamed",
                "last_name": "alfatih",
                "email": "mohamed7alfatih@gmail.com",
                "phone_number": "966571838872",
                "gender": "male",
                "role_id": 4,
                "is_active": 0,
                "profile_photo": null,
                "certificate": null
            },
            {
                "id": 18,
                "first_name": "John",
                "last_name": "Doe",
                "email": "john.doe@example.com",
                "phone_number": "9665738388720",
                "gender": "male",
                "role_id": 4,
                "is_active": 0,
                "profile_photo": null,
                "certificate": null
            },
            {
                "id": 12,
                "first_name": "meido",
                "last_name": "momo",
                "email": "meido@gmail.com",
                "phone_number": "0567390552",
                "gender": "male",
                "role_id": 3,
                "is_active": 0,
                "profile_photo": null,
                "certificate": null
            },
            {
                "id": 5,
                "first_name": "abooody updated now",
                "last_name": "tooot abodi",
                "email": "teacher@example.com",
                "phone_number": "+966-573838800",
                "gender": "male",
                "role_id": 3,
                "is_active": 0,
                "profile_photo": "http://myewanlaravelapp.loca.lt/storage/certificates/o19YqQQWmOTPuges04aUHmuftQTIcsX6qhA0RSk9.pdf",
                "certificate": null
            },
            {
                "id": 4,
                "first_name": "mohamed",
                "last_name": "alfatih",
                "email": "meido3123@gmail.com",
                "phone_number": "9665738388722",
                "gender": "male",
                "role_id": 4,
                "is_active": 0,
                "profile_photo": "images/1760617944_logo.png",
                "certificate": null
            },
            {
                "id": 2,
                "first_name": "mohamed",
                "last_name": "alfatih",
                "email": "ewangeniuses.sa@gmail.com",
                "phone_number": "+9660573838872",
                "gender": "male",
                "role_id": 1,
                "is_active": 0,
                "profile_photo": null,
                "certificate": null
            }
        ],
        "first_page_url": "http://seen-reverse-quarterly-bennett.trycloudflare.com/api/admin/users?page=1",
        "from": 1,
        "last_page": 1,
        "last_page_url": "http://seen-reverse-quarterly-bennett.trycloudflare.com/api/admin/users?page=1",
        "links": [
            {
                "url": null,
                "label": "pagination.previous",
                "active": false
            },
            {
                "url": "http://seen-reverse-quarterly-bennett.trycloudflare.com/api/admin/users?page=1",
                "label": "1",
                "active": true
            },
            {
                "url": null,
                "label": "pagination.next",
                "active": false
            }
        ],
        "next_page_url": null,
        "path": "http://seen-reverse-quarterly-bennett.trycloudflare.com/api/admin/users",
        "per_page": 25,
        "prev_page_url": null,
        "to": 9,
        "total": 9
    }
}